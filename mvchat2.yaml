# mvChat2 Server Configuration

server:
  listen: ":6060"
  api_path: "/"
  static_mount: "/"
  static_path: "./static"
  use_x_forwarded_for: true
  default_country_code: "US"
  # HTTP server timeouts (seconds) - protects against slowloris attacks
  read_timeout: 15
  write_timeout: 15
  idle_timeout: 60
  shutdown_timeout: 30
  # CORS allowed origins - use ["*"] for development only!
  # For production, specify exact origins: ["https://app.example.com"]
  allowed_origins: ["*"]

database:
  host: ${DB_HOST:localhost}
  port: 5432
  name: ${DB_NAME:mvchat2}
  user: ${DB_USER:postgres}
  password: ${DB_PASSWORD:}
  ssl_mode: disable
  max_open_conns: 50
  max_idle_conns: 50
  conn_max_lifetime: 60
  sql_timeout: 10
  # REQUIRED: Generate with: openssl rand -base64 16
  uid_key: ${UID_KEY:}
  # REQUIRED: Generate with: openssl rand -base64 32 (must be 32+ chars for AES-256)
  encryption_key: ${ENCRYPTION_KEY:}

redis:
  enabled: ${REDIS_ENABLED:false}
  addr: ${REDIS_ADDR:localhost:6379}
  password: ${REDIS_PASSWORD:}
  db: ${REDIS_DB:0}
  node_id: ${NODE_ID:node1}

email:
  enabled: ${EMAIL_ENABLED:false}
  host: ${EMAIL_HOST:mail5010.site4now.net}
  port: ${EMAIL_PORT:465}
  username: ${EMAIL_USERNAME:noreply@mvchat.app}
  password: ${EMAIL_PASSWORD:}
  from: ${EMAIL_FROM:noreply@mvchat.app}
  from_name: ${EMAIL_FROM_NAME:mvChat}

auth:
  # REQUIRED: Generate with: openssl rand -base64 32
  api_key_salt: ${API_KEY_SALT:}

  basic:
    min_login_length: 4
    min_password_length: 6

  token:
    # REQUIRED: Generate with: openssl rand -base64 32 (must be 32+ chars)
    key: ${TOKEN_KEY:}
    expire_in: 1209600    # 2 weeks in seconds
    serial_number: 1

media:
  max_size: 8388608       # 8MB
  upload_dir: "./uploads"
  gc_period: 60
  gc_block_size: 100

limits:
  max_message_size: 131072      # 128KB
  max_subscriber_count: 128
  edit_window_minutes: 15
  unsend_window_minutes: 10
  max_edit_count: 10

debug:
  expvar_path: "/debug/vars"
